Object subclass: #Regex	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Regex methodsFor: 'comparing' stamp: 'GuidoTripodi 6/21/2018 18:40'!= anotherRegex	^self value = anotherRegex value! !!Regex methodsFor: 'copying' stamp: 'NicolasHernandez 6/23/2018 15:45'!, aRegex	^Concat new create: self with: aRegex  .! !!Regex methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:07'!printString	self subclassResponsibility! !!Regex methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 18:54'!hasStar	self subclassResponsibility .! !!Regex methodsFor: 'logical operations' stamp: 'GuidoTripodi 6/21/2018 19:20'!| aRegex	^ Or new createOr: self with: aRegex! !!Regex methodsFor: 'as yet unclassified' stamp: 'GuidoTripodi 6/21/2018 19:01'!star	^ Star repeating: self.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Regex class	instanceVariableNames: ''!!Regex class methodsFor: 'requirements' stamp: 'GuidoTripodi 6/21/2018 18:57'!empty	^ Empty new.! !!Regex class methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 19:04'!b	^ Simbol withCharacter: $b.! !!Regex class methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 19:04'!a	^ Simbol withCharacter: $a.! !!Regex class methodsFor: 'local' stamp: 'NicolasHernandez 6/23/2018 19:04'!c	^ Simbol withCharacter: $c.! !Regex subclass: #Concat	instanceVariableNames: 'suffix prefix'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Concat methodsFor: 'comparing' stamp: 'NicolasHernandez 6/23/2018 18:57'!match: aString	^self existsMatchingPartitionOf: aString.! !!Concat methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 18:58'!existsMatchingPartitionOf: aString	| stringSuffix stringPrefix |	^ (0 to: aString size)		anySatisfy: [ :index | 			stringPrefix := aString first: index.			stringSuffix := aString allButFirst: index.			(prefix match: stringPrefix) and: (suffix match: stringSuffix) ]! !!Concat methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:41'!prefix	^prefix value.! !!Concat methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:41'!suffix	^suffix value.! !!Concat methodsFor: 'testing' stamp: 'NicolasHernandez 6/23/2018 15:43'!printString	^ (prefix printString , suffix printString)! !!Concat methodsFor: 'testing' stamp: 'NicolasHernandez 6/23/2018 15:42'!hasStar	^ prefix hasStar or: prefix hasStar! !!Concat methodsFor: 'testing' stamp: 'NicolasHernandez 6/23/2018 15:42'!length: aBlockClosure 	^ (prefix length: aBlockClosure) + (suffix length: aBlockClosure) .! !!Concat methodsFor: 'as yet unclassified' stamp: 'NicolasHernandez 6/23/2018 15:36'!create: aRegex1 with: aRegex2	prefix := aRegex1.	suffix := aRegex2! !Regex subclass: #Empty	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Empty methodsFor: 'comparing' stamp: 'GuidoTripodi 6/21/2018 19:46'!match: aString	^ aString = ''.! !!Empty methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 18:51'!hasStar	^ false! !!Empty methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:07'!printString	^ 'empty'! !!Empty methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:44'!length: aBlockClosure	^ 0! !Regex subclass: #Or	instanceVariableNames: 'option1 option2'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Or methodsFor: 'comparing' stamp: 'GuidoTripodi 6/21/2018 20:06'!match: aString	^ (option1 match: aString) or: (option2 match: aString)! !!Or methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:35'!option2	^option2 value.! !!Or methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:35'!option1	^option1 value.! !!Or methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 18:53'!hasStar	^ option1 hasStar or: option2 hasStar! !!Or methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:23'!printString	^ '(' , option1 printString , '|' , option2 printString , ')'! !!Or methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:35'!length: aBlockClosure	^ 1! !!Or methodsFor: 'as yet unclassified' stamp: 'GuidoTripodi 6/21/2018 19:20'!createOr: aSimbol with: aSimbol2 	option1 := aSimbol.	option2 := aSimbol2.! !Regex subclass: #Simbol	instanceVariableNames: 'valor'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Simbol methodsFor: 'comparing' stamp: 'GuidoTripodi 6/21/2018 19:52'!match: aString	 aString size = 1 ifTrue: [ ^aString first = valor].	^ false.! !!Simbol methodsFor: 'as yet unclassified' stamp: 'NicolasHernandez 6/23/2018 19:07'!character: aCharacter 	valor := aCharacter.! !!Simbol methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 18:46'!hasStar	^false.! !!Simbol methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:11'!printString	^ valor asString .! !!Simbol methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:33'!length: aBlockClosure	^1.! !!Simbol methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:47'!value	^valor.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Simbol class	instanceVariableNames: ''!!Simbol class methodsFor: 'as yet unclassified' stamp: 'NicolasHernandez 6/23/2018 19:08'!withCharacter: aCharacter 	^self new character: aCharacter.! !Regex subclass: #Star	instanceVariableNames: 'valor'	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!Star methodsFor: 'accessing structure variables' stamp: 'NicolasHernandez 6/23/2018 15:47'!value	^valor.! !!Star methodsFor: 'as yet unclassified' stamp: 'GuidoTripodi 6/21/2018 19:02'!with: aRegex 	valor := aRegex.! !!Star methodsFor: 'comparing' stamp: 'NicolasHernandez 6/23/2018 18:53'!existsMatchingPartitionOf: aString	| suffix prefix |	^(1 to: aString size)		anySatisfy: [ :index | 			prefix := aString first: index.			suffix := aString allButFirst: index.			(valor match: prefix) and: (self match: suffix)]! !!Star methodsFor: 'comparing' stamp: 'NicolasHernandez 6/23/2018 18:37'!match: aString	aString isEmpty ifFalse: [^self existsMatchingPartitionOf: aString].	^ true.! !!Star methodsFor: 'printing' stamp: 'GuidoTripodi 6/21/2018 19:25'!printString	^ '(' , valor printString , ')*'! !!Star methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:00'!hasStar	^ true! !!Star methodsFor: 'testing' stamp: 'GuidoTripodi 6/21/2018 19:41'!length: aBlockClosure	^ aBlockClosure value: 0 value: Float infinity! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Star class	instanceVariableNames: ''!!Star class methodsFor: 'instance creation' stamp: 'GuidoTripodi 6/21/2018 19:05'!repeating: aRegex	^self new with: aRegex! !TestCase subclass: #TestEj1	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj1 methodsFor: 'tests' stamp: 'NicolasHernandez 6/14/2018 19:28'!test1_1_regex	|e a b aaa a_b ab|		e := Regex empty.	a := Regex a.	b := Regex b.	aaa := a star.	a_b := a | b.	ab := a , b.		self assert: e isNotNil.	self assert: a isNotNil.	self assert: b isNotNil.	self assert: a_b isNotNil.	self assert: aaa isNotNil.	self assert: ab isNotNil.		self assert: a value equals: $a.	self assert: b value equals: $b.	self assert: aaa value equals: a.	self assert: a_b option1 equals: a.	self assert: a_b option2 equals: b.	self assert: ab prefix equals: a.	self assert: ab suffix equals: b.! !TestCase subclass: #TestEj2	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj2 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 21:53'!test2_2_printString	|e a b c aaa abc b_c aaab_c|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	abc := a , b , c.	b_c := b | c.	aaab_c := aaa , b_c.		self assert: e printString equals: 'empty'.	self assert: a printString equals: 'a'.	self assert: abc printString equals: 'abc'.	self assert: b_c printString equals: '(b|c)'.	self assert: aaa printString equals: '(a)*'.	self assert: aaab_c printString equals: '(a)*(b|c)'.! !!TestEj2 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/6/2018 03:48'!test2_1_hasStar	|e a b c aaa b_c aaab_c|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.		self assert: aaa hasStar.	self assert: aaab_c hasStar.	self assert: e hasStar not.	self assert: a hasStar not.	self assert: b_c hasStar not.! !TestCase subclass: #TestEj3	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj3 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:09'!test3_2_maxLength	|e a b c aaa b_c aaab_c max|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	max := [:x :y | x max: y].		self assert: (aaa length: max) isInfinite.	self assert: (aaab_c length: max) isInfinite.	self assert: (e length: max) equals: 0.	self assert: (a length: max) equals: 1.	self assert: (b_c length: max) equals: 1.! !!TestEj3 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:10'!test3_1_minLength	|e a b c aaa b_c aaab_c min|		e := Regex empty.	a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	min := [:x :y | x min: y].		self assert: (aaa length: min) equals: 0.	self assert: (aaab_c length: min) equals: 1.	self assert: (e length: min) equals: 0.	self assert: (a length: min) equals: 1.	self assert: (b_c length: min) equals: 1.! !TestCase subclass: #TestEj4	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'PLP'!!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_1_empty	|e|		e := Regex empty.		self assert: (e match: '').	self assert: (e match: 'a') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_3_concat	|a b ab|		a := Regex a.	b := Regex b.	ab := a , b.		self assert: (ab match: 'ab').	self assert: (ab match: '') not.	self assert: (ab match: 'a') not.	self assert: (ab match: 'aba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:06'!test4_2_char	|a b|		a := Regex a.	b := Regex b.		self assert: (a match: 'a').	self assert: (a match: '') not.	self assert: (a match: 'b') not.	self assert: (a match: 'ab') not.		self assert: (b match: 'b').	self assert: (b match: '') not.	self assert: (b match: 'a') not.	self assert: (b match: 'ba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:08'!test4_5_star	|a aaa|		a := Regex a.	aaa := a star.		self assert: (aaa match: '').	self assert: (aaa match: 'a').	self assert: (aaa match: 'aa').	self assert: (aaa match: ('a' repeat: (Random new nextInt: 10))).	self assert: (aaa match: 'b') not.	self assert: (aaa match: 'ab') not.	self assert: (aaa match: 'aab') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/7/2018 00:07'!test4_4_or	|a b a_b|		a := Regex a.	b := Regex b.	a_b := a | b.		self assert: (a_b match: 'a').	self assert: (a_b match: 'b').	self assert: (a_b match: '') not.	self assert: (a_b match: 'ab') not.	self assert: (a_b match: 'ba') not.! !!TestEj4 methodsFor: 'tests' stamp: 'EdgardoZoppi 6/11/2018 22:32'!test4_6_match	|a b c b_c aaa aaab_c bbbb|		a := Regex a.	b := Regex b.	c := Regex c.	aaa := a star.	b_c := b | c.	aaab_c := aaa , b_c.	bbbb := b star , b.		self assert: (aaab_c match: 'b').	self assert: (aaab_c match: 'c').	self assert: (aaab_c match: 'ab').	self assert: (aaab_c match: 'ac').	self assert: (aaab_c match: 'aab').	self assert: (aaab_c match: 'aaac').	self assert: (bbbb match: 'b').	self assert: (bbbb match: 'bb').	self assert: (bbbb match: 'bbb').	self assert: (bbbb match: '') not.	self assert: (aaab_c match: '') not.	self assert: (aaab_c match: 'a') not.	self assert: (aaab_c match: 'aa') not.	self assert: (aaab_c match: 'aaa') not.	self assert: (aaab_c match: 'ba') not.	self assert: (aaab_c match: 'ca') not.! !